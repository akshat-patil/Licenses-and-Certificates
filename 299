protected void btnClose_Click(object sender, EventArgs e)
{
    lblMessage.Text = string.Empty;
    if (Page.IsValid)
    {
        SqlTransaction oSqlTransaction = null;
        try
        {
            using (SqlConnection oSqlConnection = new SqlConnection(ConfigurationManager.ConnectionStrings["SiteSqlServer"].ToString()))
            {
                oSqlConnection.Open();
                oSqlTransaction = oSqlConnection.BeginTransaction();

                string sqlInsert = "UPDATE [tblScrapNote] SET status = 21, statusText = 'Scrap Note Closed at Warehouse' WHERE sid = " + hdnsid.Value;
                using (SqlCommand oSqlScrapNoteCommand = new SqlCommand(sqlInsert, oSqlConnection, oSqlTransaction))
                {
                    oSqlScrapNoteCommand.ExecuteNonQuery();
                }

                sqlInsert = "INSERT INTO [tblflow] ([sid],[addedBy],[status],[statusText],[warehouseComment]) " +
                            "VALUES (" + hdnsid.Value + ", '" + hdnuid.Value.ToString() + "', 21, 'Scrap Note Closed at Warehouse', '" + txtWHRemark.Text + "');";
                using (SqlCommand oSqlFlowCommand = new SqlCommand(sqlInsert, oSqlConnection, oSqlTransaction))
                {
                    oSqlFlowCommand.ExecuteNonQuery();
                    oSqlTransaction.Commit();
                }

                bindData();
                lblMessage.ForeColor = System.Drawing.Color.Green;
                lblMessage.Text = "Scrap Note Closed Successfully !!";
            }
        }
        catch (Exception oException)
        {
            oSqlTransaction.Rollback();
            lblMessage.ForeColor = Color.Red;
            lblMessage.Text = "Exception Occurred : " + oException.Message.ToString();
        }
    }
}





<asp:Button ID="btnClose" runat="server" Text="Accept & Close" OnClick="btnClose_Click" Visible="false" />