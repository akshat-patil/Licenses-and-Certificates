if (e.CommandName.Equals("eSelect"))
{
    Session["id"] = e.CommandArgument.ToString();

    // Collect active filter state
    var query = HttpUtility.ParseQueryString(string.Empty);
    query["id"] = e.CommandArgument.ToString();

    // Preserve page index
    if (Session["PageIndex"] != null)
        query["page"] = Session["PageIndex"].ToString();

    // Preserve filters (check controls safely)
    if (!string.IsNullOrEmpty(txtName.Text)) query["txtName"] = txtName.Text;
    if (!string.IsNullOrEmpty(txtRollNo.Text)) query["txtRollNo"] = txtRollNo.Text;
    if (!string.IsNullOrEmpty(txtDepartment.Text)) query["txtDepartment"] = txtDepartment.Text;
    if (drpCft.SelectedIndex > 0) query["drpCft"] = drpCft.SelectedValue;
    if (drpPiller.SelectedIndex > 0) query["drpPiller"] = drpPiller.SelectedValue;
    if (drpPillerName.SelectedIndex > 0) query["drpPillerName"] = drpPillerName.SelectedValue;
    if (drpCircle.SelectedIndex > 0) query["drpCircle"] = drpCircle.SelectedValue;
    if (drpStatus.SelectedIndex > 0) query["drpStatus"] = drpStatus.SelectedValue;

    Response.Redirect("~/ViewReport.aspx?" + query.ToString());
}




________


protected void btnReset_Click1(object sender, EventArgs e)
{
    var query = HttpUtility.ParseQueryString(Request.Url.Query);
    query.Remove("id"); // we donâ€™t need the record id anymore

    string url = "~/Reports.aspx";
    if (query.Count > 0)
        url += "?" + query.ToString();

    Response.Redirect(url);
}

-------


if (!IsPostBack)
{
    if (Request.QueryString["page"] != null)
        grd.PageIndex = int.Parse(Request.QueryString["page"]);

    if (!string.IsNullOrEmpty(Request.QueryString["txtName"]))
        txtName.Text = Request.QueryString["txtName"];
    if (!string.IsNullOrEmpty(Request.QueryString["txtRollNo"]))
        txtRollNo.Text = Request.QueryString["txtRollNo"];
    if (!string.IsNullOrEmpty(Request.QueryString["txtDepartment"]))
        txtDepartment.Text = Request.QueryString["txtDepartment"];
    if (!string.IsNullOrEmpty(Request.QueryString["drpCft"]))
        drpCft.SelectedValue = Request.QueryString["drpCft"];
    if (!string.IsNullOrEmpty(Request.QueryString["drpPiller"]))
        drpPiller.SelectedValue = Request.QueryString["drpPiller"];
    if (!string.IsNullOrEmpty(Request.QueryString["drpPillerName"]))
        drpPillerName.SelectedValue = Request.QueryString["drpPillerName"];
    if (!string.IsNullOrEmpty(Request.QueryString["drpCircle"]))
        drpCircle.SelectedValue = Request.QueryString["drpCircle"];
    if (!string.IsNullOrEmpty(Request.QueryString["drpStatus"]))
        drpStatus.SelectedValue = Request.QueryString["drpStatus"];

    // Now rebind grid with restored filters
    btnSubmit_Click(null, null);
}